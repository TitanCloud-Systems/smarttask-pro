Add unit tests for staking and rewards
